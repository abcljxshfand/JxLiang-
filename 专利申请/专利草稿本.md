# 专利草稿本

# 写作思路

<font color='red'>作为一名专利撰写人员，你现在要写一篇关于跨模态行人重识别的专利，你会收集哪些材料来帮助你撰写专利？</font>

要撰写一篇关于跨模态行人重识别的专利，以下是一些可以收集的材料来帮助撰写专利：

1. 技术文献和研究论文：收集关于行人重识别和跨模态行人识别方面的技术文献、学术论文和研究成果。这些文献可以提供对**现有技术和方法的了解**，同时可以**确定你的发明的创新点和优势**。

2. 专利数据库和专利文献：搜索相关的专利数据库，例如专利申请数据库和授权专利数据库，查找**已有的行人重识别和跨模态行人识别的专利文献**。这将帮助你了解相关技术领域的现有专利和技术趋势，并**确保你的发明有独特性**。

3. 技术报告和白皮书：查找行业内相关公司或研究机构发布的技术报告和白皮书，了解行人重识别和跨模态行人识别技术的最新发展、应用案例和市场需求。这些材料可以为你撰写专利的技术背景和应用前景提供支持。

4. 原始数据和实验结果：如果你已经进行了相关的实验和研究，收集实验数据和结果。这些数据可以作为专利申请中的实施效果和验证的依据，支持你的技术优势和创新点的主张。

5. 设计图纸和示意图：如果你的发明涉及硬件或系统的设计，收集相应的设计图纸、示意图或草图。这些图纸可以用于说明你的发明的结构和工作原理，为专利申请提供技术实施细节。

6. 实验设备和工具：了解用于行人重识别和跨模态行人识别的常见实验设备和工具，包括传感器、摄像机、图像处理软件等。这些信息可以帮助你描述实施专利的方式和所需的技术要求。

7. 技术专家和顾问：寻求相关领域的技术专家和顾问的意见和建议。他们可以提供对你的发明和专利申请的技术评估和专业见解，帮助你完善和优化专利申请。

收集这些材料和信息可以为你提供充分的背景知识和技术支持，帮助你撰写一篇全面且具有技术可行性的跨模态行人重

识别专利申请。请注意，在撰写专利时，务必遵守适用的法律要求和保密措施，确保专利申请的合法性和保密性。



<font color='red'>作为一名专利撰写人员，你会从哪些角度来撰写一篇关于跨模态行人重识别的专利？</font>

撰写一篇关于跨模态行人重识别的专利时，可以从以下几个角度进行撰写：

1. 技术背景：在专利中介绍行人重识别的背景和现有技术的局限性，指出传统方法在跨模态场景下的挑战和问题，以及对现有技术的改进需求。

2. 发明内容：明确专利的发明内容，包括核心技术、方法和系统。描述跨模态行人重识别的整体思路和步骤，强调与现有技术的区别和创新点。

3. 技术实施细节：详细描述实施跨模态行人重识别方法和系统的技术细节，包括数据获取、特征提取、特征对齐、特征融合和行人重识别等步骤。说明各个环节的具体算法或模型，以及如何进行数据预处理、参数设置和模型训练等。

4. 实施方式：描述实施跨模态行人重识别的硬件和软件配置，包括相应的设备、传感器、算法实现等。同时，可以提供示意图或流程图来说明系统的组成和工作原理。

5. 技术优势：突出跨模态行人重识别方法和系统的技术优势和创新点。例如，强调准确性、鲁棒性、多模态特征融合的能力以及对多种跨模态数据源的适应性。

6. 应用领域和前景：说明跨模态行人重识别方法和系统的应用领域，例如视频监控、智能安防等。强调该技术的商业潜力和市场需求，以及可能的应用前景。

7. 实施效果和验证：提供实施跨模态行人重识别方法和系统的实验结果和效果验证。可以包括对比实验、性能指标、定量分析和定性评估等。

8. 法律要求和附加要素：确保专利申请符合法律要求，包括技术可行性、创新性和工业应用性等。在需要的情况下，加入附图、附录或其他补充材料来进一步支持专利申请。

以上角度可以帮助你全面而系统地撰写关于跨模态行人重识别的专利申请。根据具体情况，你还可以添加其他相关内容，以确保专利申请的完整性和可行性。





<font color='red'>作为一名专利撰写人员，你现在要写一篇关于跨模态行人重识别的专利，和现有成果相比，如何体现你的创新性、独特性？</font>

在撰写关于跨模态行人重识别的专利时，可以通过以下方式体现创新性和独特性：

1. 提出新的跨模态特征融合方法：**强调**专利申请中提出的跨模态特征融合方法的**创新性**。**与现有方法相比**，你可以详细描述你的方法如何克服模态差异，将不同感知模态下的行人特征有效地融合，并提高行人重识别的准确性和鲁棒性。

2. 引入特征对齐的步骤：**强调**专利申请中引入的特征对齐步骤的独特性。与传统方法不同，你可以说明如何通过特征对齐方法将不同模态的特征映射到一个共享的特征空间中，从而减小模态差异的影响，提高跨模态行人重识别的性能。

3. 多模态数据的充分利用：强调专利申请中充分利用多个传感器的数据的独特性。相比于单一模态的行人数据，你可以阐述如何使用多模态数据（如RGB图像、红外图像、深度图像等）来提供更多的信息来源，增强行人重识别的性能，并在不同场景下适应性更强。

4. 应用于特定领域的创新应用：说明专利申请中跨模态行人重识别方法和系统的独特应用。强调该技术在特定领域的应用优势和创新点，如视频监控、智能安防等。与现有方法相比，阐述你的发明如何在这些领域中提供更高效的行人跟踪和重识别功能。

5. 实验结果和性能验证：提供实施专利申请中的实验结果和性能验证的数据。与现有成果相比，说明你的方法在实验中的性能表现、准确性提升或鲁棒性改进等方面的独特优势。

**通过清晰地描述你的创新方法、技术优势和应用前景**，以及提供相关实验数据的支持，可以充分体现你的专利申请在跨模态行人重识别领域的创新性和独特性。



# 专利名称

基于辅助模态和混合注意力的跨模态行人重识别方法（系统？装置？）

**所属领域：**

本发明涉及图像检索技术领域，尤其是涉及一种基于辅助模态和混合注意力的跨模态行人重识别方法。



本发明涉及行人重识别的技术领域，更具体的，涉及一种结合数据增强的轻量化跨模态行人重识别方法。

本发明涉及图像识别领域，更具体地，涉及一种基于多特征学习的跨模态行人重识别方法及系统。

本发明涉及图像处理技术领域，尤其是涉及一种基于联合中间模态和表征学习的跨模态行人重识别的方法、装置、设备和计算机可读存储介质。

本申请属于深度学习技术领域，尤其涉及一种基于中间模态的参数共享和特征学习的跨模态行人重识别方法。

本发明属于图像识别技术领域，特别涉及一种基于通道重组和注意力机制的跨模态行人重识别方法



# 本发明要解决的技术问题是什么？

**写作思路：**介绍现有技术和方法，以及它们目前所存在的一些问题。



**正文：**

跨模态行人重识别旨在匹配来自不同模态的相同身份的行人图像。现有方法主要通过生成对抗网络进行模态互转或直接提取原始图像的模态共享特征来缓解模态差异。但是，模态互转需要复杂的生成网络和判别网络，并且生成的伪图像与真实图像之间仍然存在差距，容易引入噪声。同时，由于可见光图像和红外图像之间的存在巨大的模态差异，直接提取模态共享特征十分困难，而且不能充分挖掘细微的、更具鉴别性的特征信息。本发明设计了一种基于辅助模态和混合注意力的跨模态行人重识别方法，能有效地缓解模态差异，同时挖掘细微的、更具鉴别性的特征信息。



**草稿：**

现有的跨模态行人重识别算法选择补充模态信息或直接将特征映射到共同特征空间，主要关注于缓解模态差异，而忽略细微差别的影响，这不利于模型学习到具有辨别性的身份特征。本发明使用一种基于多特征学习的跨模态行人重识别算法，可以以全局特征和局部特征结合的方式增强特征提取的信息容量，弥补仅使用一种特征造成的不足，增强特征的辨别性，提高跨模态行人重识别的精度。



现有方法大多采用深层网络参数共享的双流网络来提取两种模态的共享特征，但这不利于提取同模态下不同类之间的辨别性特征。使用局部特征虽然会使模型注意到一些细节信息，但会造成空间信息的缺失。为此，本文设计了参数独立的双流网络来分别提取可见光图像和红外图像特征，融合改进后的自注意力机制增强模型提取特征的信息容量。采用灰度化的可见光图像作为辅助模态，减缓可见光图像和红外图像在色彩上的差异。使用身份损失和异质中心损失来训练模型，提高类内不同模态的特征相似度。



# 详细介绍技术背景,并描述已有的与本发明最相近似的实现方案。

**写作思路：**（包括两部分：背景技术及现有技术方案，应详细介绍，以不需再去看文献即可领会该技术内容为准，如果现有技术出自专利、期刊、书籍，则提供出处）



**正文：**

行人重识别（Person Re-Identification, ReID）是智能监控系统的关键技术之一，是指利用计算机视觉技术在指定视频或图片序列中对特定行人进行识别的技术，旨在解决不同摄像头之间的行人检索问题。近年来，ReID获得了相当大的关注，取得了不错的进展，

**然而，**可见光摄像头在弱光或者无光（例如夜晚）的环境下，并不能捕获到有效的行人信息，与可见光相机相比，红外（IR）相机可以在黑暗环境中从场景中捕获足够的信息。但是，由于可见光图像和红外图像之间存在巨大的差异，传统单模态的行人重识别模型难以处理这两种不同模态图像之间的行人重识别任务。

**因此，**为了更有效地进行两种模态图像间的行人重识别，研究人员提出了基于可见光——红外图像跨模态行人重识别问题（Visible-Infrared Person Re-Identification, VI ReID）。

跨模态行人重识别主要需要解决模态内行人图像的差异和模态间行人图像的差异这两个问题。模态内行人图像的差异主要是由于不同的行人姿态、背景以及摄像头视角等因素造成的，例如待查询图像行人的姿势是正面，而候选集当中可能是侧面、背面，甚至是被障碍物遮挡的行人图像。模态间行人图像的差异主要是由于可见光摄像头和红外摄像头不同的成像原理造成的，例如可见图像通常有三个通道，包含丰富的视觉信息，如形状、位置、颜色和纹理。而红外图像具有一个通道，主要包含轮廓和位置信息。

根据解决方式的不同，现有的解决跨模态行人重识别问题的方法可以分成以下两种方法：模态共享特征学习和模态互转。

模态共享特征学习主要通过特征对齐的方式，把红外图像和可见光图像的特征投影到一个统一的模态共享空间中，然后通过相关的损失函数进行度量学习。模态互转主要使用生成对抗网络来生成伪图像，例如通过可见光图像来生成红外伪图像，实现了从一种模态转变成另一种模态，从而进行两种模态间的相互转换。





**草稿：**

模态共享特征学习主要通过合理的网络结构或损失函数优化，为VI ReID提取那些有鉴别性的模态共享特征，以此来减小模态间和模态内存在的差异。



使得不同模态的行人图像能够相互匹配，充分利用多种摄像头拍摄到的监控数据，达到24小时监控的目标

行人重识别是图像检索的一个子问题，主要是实现给定一个摄像机捕获的行人图像，从其他摄像设备捕获的图像库中搜索该行人的其他图像的问题。行人重识别可以有效帮助刑侦人员在监控系统中定位目标人物，从而及时应对潜在危险。目前所研究的行人重识别问题都是单模态条件下的，即用于训练和测试的数据集行人图像都是在白天拍摄到的可见光RGB图像，在现实生活中不法分子不可能只在白天出没，刑侦人员很可能需要在光线昏暗的环境中寻找目标人物，而在夜晚或者光线很差的时候，RGB图像所包含的信息会很少。红外的环境适应性优于可见光，红外摄像机可以在光线昏暗的条件下捕获到具有行人信息的图像。因此，研究基于可见光——红外图像跨模态行人重识别问题，可以使得两种模态的行人图像能够相互匹配，充分利用可见光和红外摄像头拍摄到的监控数据，达到24小时监控目标。

跨模态行人重识别问题主要存在两种对齐困难，一种是由人体姿态、摄像机视角不同、遮挡等问题引起的空间不对齐，一种是由不同成像原理引起的模态不对齐。现有的解决跨模态行人重识别问题的方法有三种，分别是基于表征学习的方法、基于度量学习的方法以及模态互转的方法。基于表征学习的方法主要设计合适的神经网络结构，来提取出两种模态图像的共同特征以及具有辨别性的身份特征，减小模态间存在的差异性。基于度量学习的方法主要设计合理的度量损失函数，学习一个映射空间，使得在空间中不同模态同一身份的图像特征距离尽可能小，不同身份的图像特征距离尽可能大。基于模态互转的方法主要研究如何讲两种模态的图像转换成同一模态图像，减少两种模态之间的差异。但现有方法大多选择仅提取全部特征或局部特征的信息来辨别行人图像身份。

如图１所示，该方法提取可见光图像和红外图像的局部特征，通过身份损失函数、分布损失函数和相关损失函数优化模型，以提取出更具有辨别性和鲁棒性的行人特征。但这种仅使用单一特征信息的方法使得模型对图像的信息提取不够充分，可能导致模型对一些信息过分依赖，影响模型从图像库中检测目标行人的准确性。



为了实现全天候监控，基于可见光——红外图像跨模态行人重识别被提出，使不同模态的行人图像能够相互匹配，充分利用多种摄像头拍摄到的监控数据。



**然而，**在光照不良或夜间的环境下，传统的可见光摄像头无法捕捉到有效的行人外观信息。**因此，**不依赖可见光即可拍摄有效行人图像的红外摄像头得到了广泛应用，**可见光-红外行人重识别问题应运而生[1]。**



**然而,** 在实际的监控系统中, 特别是在光照不足的条件下, 摄像机通常需要从可见光模式切换到近红外模式来应对这种情况. 因此, **在将此类方法应用于实际场景之前**, 有必要考虑可见光与近红外跨模态下的行人重识别问题





行人重识别［１］是判断跨相机视角拍摄的行人图像是否为同一人的技术．受视角、姿态、光照、背景变化影响，行人重识别是一个具有挑战性的任务．目前大多数研究［２－７］针对可见光相机捕捉的行人图像进行匹配，这是一个单模态行人重识别问题．然而，在智能监控系统中，只有可见光摄像机是不够的．因为当光线不足（如晚上）时，很难从可见光图像（ＶｉｓｉｂｌｅＩｍａｇｅ，ＶＩ）中提取具有判别性的行人信息．先进的监控系统能在光照不足时自动从可见光模式切换到红外模式以捕获行人的红外图像（ＩｎｆｒａｒｅｄＩｍａｇｅ，ＩＲ），获取行人有效的外观信息．由于成像原理不同，可见光图像和红外图像存在严重的模态差异．**因此，相比单模态行人重识别，红外－可见光跨模态行人重识别是一个极具挑战性的问题**．跨模态行人重识别的目的是将来自一个模态的查询图像（Ｑｕｅｒｙ）与来自另一个模态的图像库（Ｇａｌｌｅｒｙ）进行匹配，在现实场景的视频监控中较重要．相比单模态行人重识别，跨模态行人重识别面临的挑战是巨大的模态差异．因此，如何较好地缓解模态差异是跨模态行人重识别研究的一个难点

# 现有技术的缺点是什么？针对这些缺点，说明本发明的目的

（客观评价，现有技术的缺点是针对于本发明的优点来说的，本发明不能解决的缺点不必写；基于本发明能解决的问题写出发明的目的。）

**正文：**

跨模态行人重识别面临的主要挑战之一是不同模态间存在巨大的差异。现有方法中，模态互转需要复杂的生成网络和判别网络，并且生成的伪图像与真实图像之间仍然存在差距，容易引入噪声。同时，由于可见光图像和红外图像之间的模态存在巨大的差异，直接提取模态共享特征十分困难，而且不能充分挖掘细微的、更具鉴别性的特征信息。

为了能有效地缓解模态差异，同时挖掘细微的、更具鉴别性的特征信息，本发明使用辅助模态来缓解模态差异，同时使用混合注意力机制来引导模型发现不同行人图像间的细微差异。



**草稿：**

可见光图像和红外图像不仅模态间有区别，同一模态内因行人姿态、监控视角、光照强度等变化，使得同一模态同一身份的图像之间也存在诸多差异。现有是方法大多选择仅提取全部特征或局部特征的信息来辨别行人图像身份，但这会使得模型对图像的信息提取不够充分，可能导致模型对一些信息过分依赖，影响模型从图像库中检测目标行人的准确性。

为了充分利用图像信息，提高模型的泛化能力，本发明旨在以全局特征和局部特征结合的方式增强特征提取的信息容量，弥补仅使用一种特征造成的不足，增强特征的辨别性，提高跨模态行人重识别的精度。



# 本发明技术方案的基本内容



**正文：**

本发明设计一种基于辅助模态和混合注意力的跨模态行人重识别方法，能有效地缓解模态差异，同时挖掘细微的、更具鉴别性的特征信息。

该方法的网络结构如下图所示。首先，将可见光图像与红外图像输入辅助模态生成器，以生成辅助模态图像。然后，生成的辅助图像分别和原始的可见光图像与红外图像一同输入至主干网络中提取模态共享特征。其中，主干网络前三层网络层的参数是独立的，用于提取底层的模态特定特征，后面的网络层参数共享，用于提取模态共享特征。在主干网络中嵌入混合注意力引导学习模块，有效地缓解模态间的差异，同时充分挖掘具有鉴别性的模态共享特征。主干网络输出的特征图会被水平划分成若干个部分，进行局部特征的学习。最后，联合使用分布一致性损失函数、三元组损失函数、身份损失函数来对模型进行端到端优化。



![image-20230704110016105](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20230704110016105.png)



**草稿：**

如图２所示，本发明采用基于注意力思想的BoTNet为骨干网络的双流网络提取全局特征，BoTNet最后卷积模块将卷积核为3×3的卷积层更换为多头自注意力层(MHSA)，增强网络架构的全局信息聚合能力。第一层卷积和卷积模块参数不共享，用于提取特定模态的特征。后面三个卷积模块及分类器C参数共享，用于提取两种模态之间的共同特征，该模型中的分类器包含一个全连接层和一个批归一化层。对网络提取出的全局特征做水平划分，得到K个局部特征。用于局部特征的卷积层、可见光分类器C1及红外分类器C2参数不共享，使用身份损失和五元组损失来指导模型学习具有鲁棒性和辨别性的行人特征。









本发明要克服现有技术的上述缺点，提供一种基于中间模态的参数共享和特征学习的跨模态行人重识别方法，延用现有技术的中间模态生成器，将自然光和红外线图像生成中间模态图像，并自主设计了一个新的参数共享的双流网络进行特征提取，同时自主设计了全局和局部特征学习模块，克服了图像在不同模态下和不同姿态下的跨模检索问题。



![image-20230704094639047](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20230704094639047.png)

![image-20230704094618605](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20230704094618605.png)





本发明的目的在于提供一种基于联合中间模态和表征学习的跨模态行人重识别方法、装置、设备和可读存储介质，以缓解了现有技术中存在的技术问题。



本发明的目的在于针对现有技术存在的上述问题，提供一种基于统一中间模态的跨模态行人重识别方法。为对生成的中间模态图像和原始图像进行约束，降低模态差异，进一步地拉近两种中间模态图像之间的距离，除行人重识别中常用的交叉熵损失和三元组损失之外，提出一个分布一致性损失函数，充分提升跨模态行人重识别模型的性能。



鉴于上述问题，提出了本发明以便提供克服上述问题或者至少部分地解决上述问题的一种可见光‑红外跨模态行人重识别方法及系统。[0005]根据本发明的一个方面，提供了一种可见光‑红外跨模态行人重识别方法包括：









# 本发明技术方案的详细阐述

**思路：**本部分为专利申请最重要的部分，需要详细提供，专利必须是一个技术方案，应该阐述发明目的是通过什么技术手段来实现的，不能只有原理，也不能只做功能介绍；因此**发明中每一功能的实现都要有相应的技术实现方案**；所有英文缩写都应有中文注释；**必须结合流程图、原理框图、电路图、时序图等附图进行说明**，每个图都应有对应的文字详细的描述，以别人不看附图即可明白技术方案为准；同时附图中的关键词或方框图中的注释都尽量用中文；方法专利都应该提供一个流程图，并提供相关的系统装置。



**正文：**

本发明的工作流程如图所示，具体步骤：

1.获取带有身份标签的可见光VIS行人图像和红外IR行人图像，将它们**输入至辅助模态生成器中以生成对应的辅助模态图像**。

2.生成的辅助模态图像VtM、ItM和原始的可见光图像VIS和红外图像IR一同**输入至主干网络中提取模态共享特征**。<font color='red'>主干网络嵌入了混合注意力模块？（注意对应的具体步骤）</font>

3.将从主干网络提取到的特征图水平划分若干块，**进行局部特征学习**，帮助模型获取行人图像的局部信息。

4.联合使用xxxx损失、xxxx损失和xxx损失**共同优化**xxxxx跨模态行人重识别模型

~~5.将待检索的目标图像和行人数据库中的图像输入至优化后的模型中，分别提取它们的特征，并计算特征相似度，按照相似度大小输出前M张行人数据库的图像，完成行人重识别。**（测试）**~~

5.使用训练好的模型进行可见光图像和红外图像间的行人重识别。



将待识别图像输入到训练好的网络中，分别提取待识别图像特征和数据库图像特征，通过图像特征的比对，完成待识别图像的识别。



**步骤1所述辅助模态生成器**采用编码器-解码器架构，由两个编码器和两个解码器组成。生成辅助图像的具体过程为：原始的可见光图像和红外图像输入至辅助模态生成器中，可见光图像经过可见光模态信息编码器进行编码后输入至可见光模态解码器，解码器会将可见光图像投影到一个合适的辅助模态空间，以生成可见光的辅助模态。红外图像同理，经过红外模态信息编码器进行编码后输入至红外模态解码器以生成红外图像的辅助模态。





> [0008]在可选的实施方式中，所述生成中间模态图像的步骤包括：在通道级别将单通道的红外IR图像转换成三通道，以与三通道的可见光VIS图像对齐；利用两个3×1的全连接层FC分别对所述可见光VIS图像和所述红外IR图像进行编码，将三通道图像转换为单通道图像；分别使用两个1×1的全连接层FC进行特征降维；将降维后的特征进行拼接，输入到一个由全连接层FC和激活层ReLU构成的解码器中，使编码得到的单通道图像投影到统一的三通道图像，以生成所述中间模态图像。
>
> 
>
> [0010]在步骤1)中，所述将两种模态图像分别输入到两个编码器中进行编码的具体步骤**可为：将白天的三通道彩色图像(VIS图像)与夜间的单通道灰度图像(NIR图像)这两种模态图像的差异在通道层面实现对齐，可采用由两个3*1全连接层组成的模态特定的编码器Evis和Enir，从而得到两种1*1的单通道图像。
>
> **[0011]在步骤2)中，所述将编码得到的两种特征输入到两个非线性激活函数中用于加深其非线性表达能力**，由于跨模态的两种图像之间存在着巨大的非线性跨模态差异，将编码得到的两种1*1的单通道图像输入到两个3*1全连接层后跟ReLU激活函数中用于提升其特征表达能力。
>
> **[0012]在步骤3)中，所述得到中间模态图像的具体方法可为：**将两种通过ReLU激活函数的1*1的单通道图像输入到一个模态共享的由1*3全连接层组成的解码器中，将这两种模态的图像解码到一个共享的图像空间中，得到中间模态图像。



**步骤2所述的主干网络**采用ResNet50作为双流网络的基础网络，前三个网络层参数独立，用以提取模态特定特征。后面的网络层参数共享，用以提取模态共享特征。其中，在网络层3和网络层4后面嵌入的CBAM（卷积注意力机制）模块，它使用混合注意力，联合通道注意力和空间注意力，能帮助模型排除背景噪声的干扰，关注行人图像间的细微差异，挖掘更具鉴别性的特征信息。（通道注意力作用？空间注意力作用？具体流程？）

<font color='red'>CBAM公式：</font>



> [0015]步骤S2所设计的参数共享的双流网络对resnet50网络进行划分，其中第零个卷积层和第一个卷积层参数不共享用于构造模态特定特征提取网络，以提取模态特定特征；第二，三，四个卷积层参数共享，用于构造模态共享特征嵌入网络，以提取模态共享特征。
>
> 
>
> [0009]在可选的实施方式中，**所述参数共享的特征提取网络采用ResNet50作为双流网络的基础网络**，并将ResNet50前三个阶段作为特征提取器提取所述两种模态独立的特征，后两个阶段作为特征嵌入器进行参数共享。
>
> 
>
> [0013]**在步骤4)中，所述将得到的中间模态图像与原始图像一起输入到网络中进行优化的具体步骤可为**：将原始的VIS图像、NIR图像与步骤3)所得中间模态图像一起输入ResNet‑50网络中用于辅助原始图像进行学习，输出的特征输出的特征通过PCB技术用于进一步的提升模型性能，最终通过三元组损失函数LTri、分布一致性损失函数LDcl、交叉熵损失函数Lid进行自监督的优化；**总体损失函数L表示如下**：



**步骤三所述的局部特征学习具体流程为**，首先对主干网络提取的特征图进行广义平均池化，然后将其平均匀切分成四块，进行局部特征学习，这样可以帮助模型关注图像细节信息，减少背景噪声的干扰。

<font color='red'>广义平均池化公式：</font>





> [0013]S3.将提取的特征图送入所设计的**全局和局部特征学习**模块，从粗粒度和细粒度两个层次减少模态差异；
>
> [0016]步骤S3所述全局和**局部特征学习**，采用对行人水平切片获取局部特征，并对局部特征采用Lidloss与Lhc_triloss的组合监督；对全局特征采用Lccloss监督。
>
> 
>
> 基于多粒度池化策略，采用全局特征与局部特征相结合的策略和广义平均池化优化基于联合中间模态和表征学习的跨模态行人重识别模型；
>
> [0010]在可选的实施方式中，所述多粒度池化策略包括：采用全局特征分支和局部特征分支的多粒度池化结构和广义平均池化方法；其中，上半部分为所述全局特征分支，所述全局特征分支将所述参数共享的特征提取网络输出的特征进行预设步长的采样，以学习全局特征；下半部分为所述局部特征分支，所述局部特征分支将所述参数共享的特征提取网络输出的特征进行水平均匀分为预设数量块，以学习细粒度的局部特征学习。
>
> [0011]在可选的实施方式中，所述预设步长为2，所述预设数量块为4块。
>
> 广义平均池化更加关注图像细节信息，防止容易受到背景和遮挡的干扰且很难获取到行人的细节特征的弊端。
>
> 下半部分为局部特征分支，该分支对参数共享网络输出后的特征进行水平均匀分块，将图像分为四块，进行细粒度的局部特征学习。
>
> 





**步骤4所述的**总体损失函数如下所示：



其中Lxx，是xxx



[0012]S4.使用Ldclloss训练中间模态生成器，使得生成的中间模态图像更加接近，Lidloss与Lhc_triloss的组合监督局部特征，Lccloss监督全局特征，**总体损失L为上述loss的总和**，通过总体损失L的反向传播对中间模态生成器和双流主干网络的参数进行优化；



![image-20230704191230963](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20230704191230963.png)



**草稿：**





![image-20230704145412432](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20230704145412432.png)

本发明的**工作原理：**将可见光图像和红外图像分别输入到双流网络的两个分支里，分别提取出每个图像的全局特征，对每个批次的全局特征计算身份损失和困难五元组损失来训练模型提取两个模态共有的信息，缩小模态间的差异。对全局特征做水平划分，得到K个局部特征，通过对局部特征计算身份损失，使得模型能够注意到每个图像里的细微差别，进而提取出同个模态下不同身份图像之间具有辨别性的信息。流程如图3所示，**具体步骤如下：**

[0006]为解决上述技术问题，本发明的技术方案如下：

[0007]第一个方面，本发明提出一种基于多特征学习的跨模态行人重识别方法，包括以下步骤：

[0008]S1：构建包括双流网络的跨模态行人重识别模型；

[0009]S2：随机获取若干批次行人的可见光图像和红外图像，构建训练集和测试集；

[0010]S3：按批次将所述可见光图像和所述红外图像分别输入跨模态行人重识别模型中，跨模态行人重识别模型输出可见光图像和红外图像的全局特征，以及可见光图像和红外图像局部特征；

[0011]S4：根据所述全局特征计算困难五元组损失和全局身份损失，根据所述局部特征计算特定身份损失；

[0012]S5：根据困难五元组损失、全局身份损失和特定身份损失构建跨模态行人重识别模型的整体损失函数，根据所述整体损失函数对跨模态行人重识别模型进行参数优化；

[0013]S6：将测试集中的图像和待识别的目标图像输入优化后的跨模态行人重识别模型，计算待识别的目标图像与测试集中的图像之间的特征相似度，输出测试集中前M张与待识别的目标图像特征相似度最高的图像，作为行人重识别结果。









S1**.获取训练数据集**，所述训练数据集中每个训练样本为带有身份标注的可见光和红外线图像，将训练样本**输入到所提出中间模态生成器中，所生成的中间模态图像和原始图像具有相同的身份标识；**

[0010]S2.将生成的中间模态图像Mvis，Mir与原始图像VIS，IR一起送入**所设计的参数共享的双流网络**中提取模态共享特征；

[0013]S3.将提取的特征图送入所设计的**全局和局部特征学习**模块，从粗粒度和细粒度两个层次减少模态差异；

[0012]S4.使用Ldclloss训练中间模态生成器，使得生成的中间模态图像更加接近，Lidloss与Lhc_triloss的组合监督局部特征，Lccloss监督全局特征，总体损失L为上述loss的总和，通过总体损失L的反向传播对中间模态生成器和双流主干网络的参数进行优化；

[0013]S5.将待识别图像输入到训练好的网络中，分别提取待识别图像特征和数据库图像特征，通过图像特征的比对，完成待识别图像的识别。

[0014]步骤S1**所述中间模态生成器**包含两个参数不共享的模态信息编码器Evis，Eir，以及一个参数共享的模态信息解码器D将VIS和IR图像投影到统一的特征空间。

[0015**]步骤S2所设计的参数共享的双流网络**对resnet50网络进行划分，其中第零个卷积层和第一个卷积层参数不共享用于构造模态特定特征提取网络，以提取模态特定特征；第二，三，四个卷积层参数共享，用于构造模态共享特征嵌入网络，以提取模态共享特征。

[0016]步骤S3所述全局和**局部特征学习**，采用对行人水平切片获取局部特征，并对局部特征采用Lidloss与Lhc_triloss的组合监督；对全局特征采用Lccloss监督。

[0017]步骤S4所述总体损失L表示如下：





第一方面，本发明实施例提供一种基于联合中间模态和表征学习的跨模态行人重识别方法，所述方法包括：

获取可见光VIS图像和红外IR图像两种模态的原始图像；

利用中间模态生成器将所述两种模态的原始图像映射到统一的特征空间，**以生成中间模态图像**；

将所述中间模态图像与所述原始图像联合输入到参数共享的特征提取网络；

基于多粒度池化策略，采用全局特征与局部特征相结合的策略和广义平均池化优化基于联合中间模态和表征学习的跨模态行人重识别模型；

采用分布一致性损失、标签平滑交叉熵损失和异质中心三元组损失的联合损失共同优化基于联合中间模态和表征学习的跨模态行人重识别模型；

应用优化后的基于联合中间模态和表征学习的跨模态行人重识别模型识别待识别图像。

[0008]在可选的实施方式中，**所述生成中间模态图像的步骤包括**：在通道级别将单通道的红外IR图像转换成三通道，以与三通道的可见光VIS图像对齐；利用两个3×1的全连接层FC分别对所述可见光VIS图像和所述红外IR图像进行编码，将三通道图像转换为单通道图像；分别使用两个1×1的全连接层FC进行特征降维；将降维后的特征进行拼接，输入到一个由全连接层FC和激活层ReLU构成的解码器中，使编码得到的单通道图像投影到统一的三通道图像，以生成所述中间模态图像。

[0009]在可选的实施方式中，**所述参数共享的特征提取网络采用ResNet50作为双流网络的基础网络**，并将ResNet50前三个阶段作为特征提取器提取所述两种模态独立的特征，后两个阶段作为特征嵌入器进行参数共享。

[0010]在可选的实施方式中，所述多粒度池化策略包括：采用全局特征分支和局部特征分支的多粒度池化结构和广义平均池化方法；其中，上半部分为所述全局特征分支，所述全局特征分支将所述参数共享的特征提取网络输出的特征进行预设步长的采样，以学习全局特征；下半部分为所述局部特征分支，所述局部特征分支将所述参数共享的特征提取网络输出的特征进行水平均匀分为预设数量块，以学习细粒度的局部特征学习。

[0011]在可选的实施方式中，所述预设步长为2，所述预设数量块为4块。

[0012]在可选的实施方式中，所述分布一致性损失函数为：





[0005]本发明包括以下步骤：

[0006]1)将两种模态图像分别输入到两个编码器中进行编码；

[0007]2)将编码得到的两种特征输入到两个非线性激活函数中用于加深其非线性表达能力；

[0008]3)将非线性激活后的两种特征输入到一个共享的解码器中，并解码到一个统一的中间图像空间中，得到中间模态图像；

[0009]4)将得到的中间模态图像与原始图像一起输入到网络中进行优化，完成跨模态行人重识别。

**[0010]在步骤1)中，所述将两种模态图像分别输入到两个编码器中进行编码的具体步骤**可为：将白天的三通道彩色图像(VIS图像)与夜间的单通道灰度图像(NIR图像)这两种模态图像的差异在通道层面实现对齐，可采用由两个3*1全连接层组成的模态特定的编码器Evis和Enir，从而得到两种1*1的单通道图像。

**[0011]在步骤2)中，所述将编码得到的两种特征输入到两个非线性激活函数中用于加深其非线性表达能力**，由于跨模态的两种图像之间存在着巨大的非线性跨模态差异，将编码得到的两种1*1的单通道图像输入到两个3*1全连接层后跟ReLU激活函数中用于提升其特征表达能力。

**[0012]在步骤3)中，所述得到中间模态图像的具体方法可为：**将两种通过ReLU激活函数的1*1的单通道图像输入到一个模态共享的由1*3全连接层组成的解码器中，将这两种模态的图像解码到一个共享的图像空间中，得到中间模态图像。

[0013]**在步骤4)中，所述将得到的中间模态图像与原始图像一起输入到网络中进行优化的具体步骤可为**：将原始的VIS图像、NIR图像与步骤3)所得中间模态图像一起输入ResNet‑50网络中用于辅助原始图像进行学习，输出的特征输出的特征通过PCB技术用于进一步的提升模型性能，最终通过三元组损失函数LTri、分布一致性损失函数LDcl、交叉熵损失函数Lid进行自监督的优化；**总体损失函数L表示如下**：



# 本发明的关键点和欲保护点是什么？

**思路：**

（发明内容部分提供的是为完成一定功能的完整技术方案，本部分是提炼出技术方案的关键创新点，列出1、2、3...，以提醒代理人注意，便于专利代理人撰写权利要求书。）



**正文：**

（1)设计一个辅助模态生成器来生成可见光模态和红外模态所对应的辅助图像，有效地缓解了两种模态间的差异。辅助模态生成器能促进主干网络的优化过程，主干网络的优化也能促进辅助模态生成器生成更好的辅助模态图像。

（2）设计一个新的双流网络来更好地提取不同模态图像间具有鲁棒性和辨别性的行人特征。在主干网络中，前三个网络层参数独立，用以提取模态特定特征。后面的网络层参数共享，用以提取模态共享特征。在主干网络嵌入嵌入的CBAM（卷积注意力机制）模块，该模块使用混合注意力，联合通道注意力和空间注意力，能帮助模型排除背景噪声的干扰，关注行人图像间的细微差异，挖掘更具鉴别性的特征信息。然后对主干网络提取的特征图进行广义平均池化，然后将其水平均匀切分成四块，进行局部特征学习，帮助模型关注图像细节信息。







**草稿：**

1)设计一个新的双流网络来更好地提取不同模态图像间具有鲁棒性和辨别性的行人特征。使用基于注意力思想的BoTNet为骨干网络，相较于使用Resnet50网络，减少了网络参数，并增强网络架构的全局信息聚合能力。模型只选取后三个卷积模块及分类器C参数共享，使得其能在提取特定于身份特征的同时提取到两个模态下的共同特征。

2)使用局部特征和全局特征计算身份损失，考虑细微差别，训练模型在提取两个模态下共同特征的同时提取特定身份的辨别性特征。





# 与第2条所属的最好的现有技术相比，本发明有何优点？

**思路：**

（效果一定要结合发明内容的技术方案来描述，做到有理有据；也可以对应本发明所要解决的技术问题来描述，一定是采用本发明技术方案带来的效果；效果可以是降低成本，提高了效率等。）

优点是：

1.相比于使用生成对抗网络进行模态互转，本发明所设计的辅助模态生成器是一个轻量级的生成器，减少了计算量，同时引入的辅助模态图像能有效地减缓两种模态图像间的模态差异。

2.大部分现有方法主要通过特征对齐的方式来解决跨模态行人重识别问题，本发明设计的双流网络有效地缓解了模态差异的同时，能发现不同行人图像间的细微差异，提取出更具鲁棒性和鉴别性的特征信息，提高模型的性能。







**草稿：**

优点是：在减少模型网络参数、不添加改变原始数据操作的情况下，结合全局特征和局部特征增强特征提取的信息容量，弥补仅使用一种特征造成的不足，增强特征的辨别性，提高跨模态行人重识别的精度。





# 本发明是否经过实验、模拟、使用而证明可行，结果如何？

**正文：**

经过试验，证明可行。，模型在测试中的mAP（平均精度均值）和rank-k值得到明显地提高，能够很好地解决跨模态行人重识别任务。





**草稿：**

经过试验，证明可行。在减少模型网络参数、不添加改变原始数据操作的情况下，模型在图像库中检索目标图像的mAP（平均精度均值）得到提高，能够很好地解决跨模态行人重识别任务。



# 本发明的变更设计（替代方案）及其它用途：

此算法还可用于一些跨模态人脸识别，跨模态目标检索等领域。





# 附图及说明

