# 广大硕士论文-模态分布批归一化和优化损失函数

## 目录结构

![广大论文目录](D:\Picture\行人重识别\广大论文目录.PNG)

![广大硕士毕业论文2](D:\Picture\行人重识别\广大硕士毕业论文2.PNG)

## 摘要总结

不少监控摄像头在夜间等光照条件不好的情况下会进入红外模式，拍摄红外图像。为了能处理可见光图像和红外光图像间的行人检索，需要研究可见光-红外光跨模态行人重识别模型。本文主要进行了两项工作。

1. **模态批归一化模块**。缓解跨模态行人重识别中存在的模态分布差异。同一件衣服的可见光图像和红外光图像有很大的差异，但是却要提取相似的特征。
2. **统一了行人重识别中用到的损失函数的度量。**入了随机灰度化数据增广方法，在减少可见光图像和红外光图像的模态差异的同时，增加了训练数据量。本文也取消了样本对间损失函数的难样本对选择，使得在每次迭代中，更多的跨模态样本对可以得到优化。



## 绪论

### 背景

监控摄像头一般工作在可见光模式，拍摄彩色图像。但在光照条件较差的情况下，比如夜间户外，大部分监控摄像头会切换成红外光模式，拍摄灰度图像。相较于可见光图像，红外光图像除了缺少颜色以外，还损失了很多纹理细节。因为这两类图像的差异非常大，现有单模态和跨模态模型效果不好。

![CMC曲线](D:\Picture\行人重识别\跨模态行人重识别\CMC曲线.png)

### 研究目标

可见光-红外光跨模态行人重识别任务，用于检索的图像是红外光图像，图库行人图像是可见光图像（**infrared to visible**）；或者检索图像是可见光图像，图库行人图像是红外光图像（**visible to infrared**）。 

**infrared to visible**

![image-20221107202943076](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107202943076.png)



### 优化目标

#### 补充：度量学习

![image-20221107204505414](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107204505414.png)

![image-20221107204949531](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107204949531.png)

用卷积网络从图像中提取出特征图，然后用全局池化将其变成一维向量，最后计算一维向量间的欧几里得距离，距离越近，相似度越高。则**优化目标**是所提取出来的一维向量间的相似度。<font color='red'>**对于属于同一个人的图像，要求卷积网络抽取出来特征有较高的相似度；对于属于不同行人的图像，要求抽取出来特征相似度较低。**</font>

使用**分类损失函数**:但对于行人重识别而言，训练时用的可能是前700个行人ID的图像，测试时用的是另外1000个行人ID图像，也就是说卷积网络根据训练集学到的行人ID分类信息，在测试的时候没有用了。这就是行人重识别的难点，训练集的行人图像只包含采集当天路过采集地点的几百个人，却要将**模型泛化**到任何时间在任何地点中可能出现的每一个人。因此，希望模型能够抽取低层次的特征，如衣服、裤子这类型的特征。通过这些特征的组合就有可能泛化到任何一个人。然而，训练集只给每个行人标注一个ID，并没有细致到衣服、裤子这个层次。(单纯用分类损失函数，模型泛化性有待提高)

使用两类损失函数 **Pairwise Loss**和 **Proxy Loss**

#### **PairwiseLoss**

**目标：**直接优化样本间的相似度，要求属于同一个行人ID的样本相似度高，属于不同行人ID的样本相似度低。

**定义：**PairwiseLoss要求在训练时，每次迭代中，对于每张行人图像，都应该要有正样本和负样本。所以大多数行人重识别模型都采用PK采样策略。即随机选择P个行人，然后为每个选中的行人随机选择K张图像，共PK张图像构成一次迭代所用的样本。对于每张行人图像来说，有K-1个正样本和(P-1)K个负样本。图2-3(a)是P=3，K=2的一个示例。

**常用的 Pairwise Loss：** **Triplet loss**



![image-20221107213846983](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107213846983.png)

![image-20221107214622563](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107214622563.png)

![image-20221107214743317](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107214743317.png)

![image-20221107214828604](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20221107214828604.png)